---
title: "Week_3 605 assignment"
author: "Salma Elshahawy"
date: "1/21/2020"
output: 
  pdf_document: 
    extra_dependencies: ["geometry"]
    latex_engine: xelatex
    keep_tex: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Problem set_1

### (1) What is the rank of the matrix A?

$\begin{bmatrix} 1 & 2 & 3 & 4 \\ -1 & 0 & 1 & 3 \\ 0 & 1 & -2 & 1 \\ 5 & 4 & -2 & -3 \end{bmatrix}$

```{r}
a_mEn <- matrix(c(1,2,3,4,
              -1,0,1,3,
              0,1,-2,1,
              5,4,-2,-3), 4, byrow=T)
# a <- matrix(c(0,1,2,1,2,7,2,1,8), ncol = 3)
a_mEn
```

```{r}
a_mbn <- matrix(c(1,2,3,4,
              -1,0,1,3), 4, byrow=T)
a_mbn
```

```{r}
a_mln <- matrix(c(1,2,3,4,
              -1,0,1,3), 2, byrow=T)
a_mln
```

```{r}
get_echoln <- function(a) {
  U = a
  n = ncol(a)
  m = nrow(a)
  if(m == n) {
    for (i in 1:n) {
      for (j in 2:m) {
        if(U[j,i] != 0 & j > i) {
          # Add multiples of the pivot row to each of the lower rows, 
          # so every element in the pivot column of the lower rows equals 0.
          mplier = U[[j,i]]/U[[i,i]]
          # reduce by reduction and subtitute in the U matrix
          U[j,] = U[j,] - mplier * U[i,]
        } else if (U[j,i] != 0 & j == i) {
          U[j,] = U[j,] / U[[j,i]]
        }# end if
      } # end if 
    } # end for
  } else if(m < n) {
    for (i in 1:n) {
      for (j in 2:m) {
        if(U[j,i] != 0 & j > i) {
          U[i,] = U[i,] / U[[i,i]]
          # Add multiples of the pivot row to each of the lower rows, 
          # so every element in the pivot column of the lower rows equals 0.
          mplier = U[[j,i]]/U[[i,i]]
          # reduce by reduction and subtitute in the U matrix
          U[j,] = U[j,] - mplier * U[i,]
          
        } else if(U[j,i] != 0 & j == i) {
          U[i,] = U[i,] / U[[i,i]]
        } # end if
      } # end for
    } # end for
  } else if (m > n) {
    for (i in 1:n) {
      for (j in 2:m) {
        if(U[j,i] != 0 & j > i) {
          U[i,] = U[i,] / U[[i,i]]
          # Add multiples of the pivot row to each of the lower rows, 
          # so every element in the pivot column of the lower rows equals 0.
          mplier = U[[j,i]]/U[[i,i]]
          # reduce by reduction and subtitute in the U matrix
          U[j,] = U[j,] - mplier * U[i,]
          
        } else if(U[j,i] != 0 & j == i) {
          U[i,] = U[i,] / U[[i,i]]
        } # end if
      } # end for
    } # end for
  } # end if 
  return(round(U, digits = 1))
}

equal = get_echoln(a_mEn)
equal

greater = get_echoln(a_mbn)
greater

lesser = get_echoln(a_mln)
lesser
```
```{r warning=False, message=False}

# rank needs to be modified
ranking = function(cd) {
  rank = 0
  # sol = as.array(colSums(cd))
  # [1]  1  3  6 10
  for (i in 1:nrow(cd)) {
    if(sum(cd[i,]) > 0 & ncol(cd) == nrow(cd)) {
      rank = rank + 1
    } else if (sum(cd[i,]) > 0 & ncol(cd) > nrow(cd)) {
      rank = rank + 1
      # rank = max(nrow(cd), rank)
    } else if (sum(cd[i,]) > 0 & ncol(cd) < nrow(cd)){
      rank = rank + 1
      # rank = max(ncol(cd), rank)    
    }
  }
  return(rank)
}

r1 = ranking(equal)
r1

r2 = ranking(greater)
r2

r3 = ranking(lesser)
r3
```

### (2) Given an $m\timesn$ matrix where m > n, what can be the maximum rank? The minimum rank, assuming that the matrix is non-zero?

+ If m is greater than n, then the maximum rank of the matrix is **n** _(number of columns)_.

+ If m is less than n, then the maximum rank of the matrix is **m** _(number of rows)_.

### (3) What is the rank of matrix B?

$\begin{bmatrix} 1 & 2 & 1 \\ 3 & 6 & 3 \\ 2 & 4 & 2 \end{bmatrix}$

```{r}
B <- matrix(c(1,2,1,
              3,6,3,
              2,4,2), 3, byrow = T)

B

B_echoln = get_echoln(B)
B_echoln
B_rank = ranking(B_echoln)
B_rank
```



